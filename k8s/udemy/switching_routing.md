# Switching Routing

<br>

### Prerequisite::Command

<table>
<tr>
<th></th>
<th>Command</th>
</tr>
<tr>
<th>í˜¸ìŠ¤íŠ¸ì˜ ì¸í„°í˜ì´ìŠ¤ ëª©ë¡</th>
<td><pre><code>$ ip link</code></pre></td>
</tr>
<tr>
<th>ì¸í„°í˜ì´ìŠ¤ì— í• ë‹¹ëœ IP ì£¼ì†Œ í™•ì¸</th>
<td><pre><code>$ ip addr</code></pre></td>
</tr>
<tr>
<th>ì„ì‹œì ìœ¼ë¡œ IP ì£¼ì†Œ ì„¤ì •</th>
<td>
<pre><code>$ ip addr add 192.168.1.10/24 dev eth0</code></pre>

ìœ„ ëª…ë ¹ì–´ëŠ” í˜¸ìŠ¤íŠ¸ë¥¼ Restart í•˜ê¸° ì „ê¹Œì§€ë§Œ ìœ íš¨í•¨

ë³€ê²½ ì‚¬í•­ì„ ì˜êµ¬ ìœ ì§€í•˜ë ¤ë©´ `/etc/network/interfaces` íŒŒì¼ì— ì„¤ì •í•´ì•¼ í•¨

</td>
</tr>
<tr>
<th> ë¼ìš°íŒ… í…Œì´ë¸” ì¡°íšŒ</th>
<td>
<pre><code>$ ip route
# or
$ route
</code></pre>
</td>
</tr>
<tr>
<th> ë¼ìš°íŒ… í…Œì´ë¸”ì— ì—”íŠ¸ë¦¬ë¥¼ ì¶”ê°€</th>
<td>
<pre><code>$ ip route add 192.168.1.0/24 via 192.168.2.1</code></pre>
</td>
</tr>
<tr>
<th> IP í¬ì›Œë”©ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸</th>
<td>
<pre><code>$ cat /etc/sysctl.conf</code></pre>

í˜¸ìŠ¤íŠ¸ì— ë¼ìš°í„° êµ¬ì„± ì‘ì—…ì„ í•˜ëŠ” ê²½ìš° ì‚¬ìš©

</td>
</tr>
</table>


<br>

### Switch

ì»´í“¨í„° Aì™€ Bê°€ ìˆë‹¤ê³  í•  ë•Œ, (ê°€ë ¹, ë…¸íŠ¸ë¶ê³¼ ë°ìŠ¤í¬í†±, í´ë¼ìš°ë“œ, VM)

Aì™€ Bë¥¼ ì—°ê²°í•˜ë ¤ë©´ ë‘ ì‹œìŠ¤í…œì„ í¬í•¨í•˜ëŠ” ë„¤íŠ¸ì›Œí¬ë¥¼ ìƒì„±í•˜ëŠ” ìŠ¤ìœ„ì¹˜ë¡œ ë‘ ì‹œìŠ¤í…œì„ ì—°ê²°

ìŠ¤ìœ„ì¹˜ì— ì—°ê²°í•˜ë ¤ë©´ ê° í˜¸ìŠ¤íŠ¸ì— ì¸í„°í˜ì´ìŠ¤ê°€ í•„ìš”í•˜ë©°, ì´ëŠ” í˜¸ìŠ¤íŠ¸ì— ë”°ë¼ ë¬¼ë¦¬ì  ë˜ëŠ” ê°€ìƒì˜ í˜•ì‹ì¼ ìˆ˜ ìˆìŒ

<br><img src="./img/linux_networking_basics_img1.png" width="70%"><br>

í˜¸ìŠ¤íŠ¸ì˜ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë³´ê¸° ìœ„í•´ì„œëŠ” IP ë§í¬ ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ

`eth0` ì´ë¦„ì˜ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìŠ¤ìœ„ì¹˜ì— ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©í•œë‹¤ê³  í•˜ë©´, 
ë„¤íŠ¸ì›Œí¬ê°€ `192.168.1.0` ë¼ê³  í•˜ë©´, 
ë™ì¼í•œ ë„¤íŠ¸ì›Œí¬ì— ìœ„ì¹˜í•  `192.168.1.10` ì™€ `192.168.1.11` ë¥¼ ê° ì»´í“¨í„°ì˜ `eth0`ì— í• ë‹¹

- System A: `192.168.1.10`
- System B: `192.168.1.11`

ì´ë¥¼ ìœ„í•´ `ip addr` ëª…ë ¹ì–´ ì‚¬ìš©

```Bash
ip addr add 192.168.1.10/24 dev eth0
ip addr add 192.168.1.11/24 dev eth0
```

ë“±ë¡í•œ ë§í¬ê°€ ì ìš©ë˜ì–´ IP ì£¼ì†Œê°€ í• ë‹¹ë˜ë©´ ë‘ ì»´í“¨í„°ëŠ” ìŠ¤ìœ„ì¹˜ë¥¼ í†µí•´ ì„œë¡œ í†µì‹ í•  ìˆ˜ ìˆìŒ

ìŠ¤ìœ„ì¹˜ëŠ” ìì‹ ì˜ ë„¤íŠ¸ì›Œí¬ ë‚´ì—ì„œë§Œ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•¨

ì¦‰, ë„¤íŠ¸ì›Œí¬ ìƒì˜ í˜¸ìŠ¤íŠ¸ë¡œë¶€í„° íŒ¨í‚·ì„ ë°›ì•„ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ë‚´ì˜ ë‹¤ë¥¸ ì‹œìŠ¤í…œìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŒ

<br>

### Router

ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ `192.168.2.0`ì— ì‹œìŠ¤í…œ Cì™€ Dì´ ìˆë‹¤ê³  ê°€ì •

- System C: `192.168.2.10`
- System D: `192.168.2.11`

ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ì´ë£¨ì–´ì§

<br><img src="./img/linux_networking_basics_img2.png" width="70%"><br>

ì„œë¡œ ë‹¤ë¥¸ ë‘ ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ë ¤ë©´ **ë¼ìš°í„°**ë¥¼ ì‚¬ìš©í•´ì•¼í•¨

ë¼ìš°í„°ëŠ” ê° ë„¤íŠ¸ì›Œí¬ë¥¼ ì—°ê²°í•˜ë„ë¡ ë„ì™€ì¤Œ

<br><img src="./img/linux_networking_basics_img3.png" width="70%"><br>

ë„¤íŠ¸ì›Œí¬ê°€ í•˜ë‚˜ì˜ ë°©ì´ë¼ë©´, ë°©ì´ ë°–ê¹¥ ì„¸ìƒê³¼ ì—°ê²°ë  ë¬¸ì´ ë¼ìš°í„°

ê° ë°©ì€ ë¬¸ì´ ì–´ë””ì™€ ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ ì•Œì•„ì•¼ í•¨

í˜„ì¬ ì—°ê²°ëœ ë¼ìš°íŒ… ì„¤ì •ì„ í™•ì¸í•˜ë ¤ë©´ `route` ëª…ë ¹ì–´ë¥¼ ì…ë ¥

`route` ëª…ë ¹ì–´ëŠ” ì»¤ë„ì˜ ë¼ìš°íŒ… í…Œì´ë¸”ì„ ì¶œë ¥

```Bash
$ route
Kernel IP routing table
Destination     Gateway     Genmask     Flags Metric Ref    User Iface
```

ìœ„ë¥¼ ì‚´í´ë³´ë©´ í˜„ì¬ ë“±ë¡ëœ ë¼ìš°íŒ… ì„¤ì •ì´ ì—†ìŒ

ì´ ê²½ìš°ëŠ” ì‹œìŠ¤í…œ BëŠ” ì‹œìŠ¤í…œ Cì•  ì ‘ê·¼í•  ìˆ˜ ì—†ìŒ 

ì‹œìŠ¤í…œ BëŠ” ë™ì¼í•œ ë„¤íŠ¸ì›Œí¬ì¸ `192.168.1.0` ì—ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆìŒ

ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ì¸ `192.168.2.0` ëŒ€ì—­ì— ì ‘ê·¼í•˜ê³  ì‹¶ë‹¤ë©´, ì•„ë˜ì™€ ê°™ì´ ì„¤ì •ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŒ

```Bash
$ ip route add 192.168.2.0/24 via 192.168.1.1
```

ë¼ìš°íŒ… ì„¤ì •ì„ ë‹¤ì‹œ í™•ì¸í•˜ë©´ ì•„ë˜ì™€ ê°™ìŒ

```Bash
# System B's routing configuration

$ route
Kernel IP routing table
Destination     Gateway         Genmask         Flags   Metric  Ref     User Iface
192.168.2.0     192.168.1.1     225.225.225.0   UG      0       0           0 eth0
```

ë‹¨, ëª¨ë“  ì‹œìŠ¤í…œì— ëª¨ë‘ ì´ë¥¼ ì„¤ì •í•´ì•¼ í•¨

ê°€ë ¹, ìœ„ì™€ ê°™ì€ ê²½ìš° ì‹œìŠ¤í…œ Bì—ì„œ ì‹œìŠ¤í…œ Cê¹Œì§€ í†µì‹ ì´ ê°€ëŠ¥í•œë°, 
ì‹œìŠ¤í…œ Cì—ì„œ ì‹œìŠ¤í…œ Bë¥¼ ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì„¤ì •ë„ í•„ìš” 

```Bash
$ ip route add 192.168.1.0/24 via 192.168.2.1
```

```Bash
# System C's routing configuration

$ route
Kernel IP routing table
Destination     Gateway         Genmask         Flags   Metric  Ref     User Iface
192.168.1.0     192.168.2.1     225.225.225.0   UG      0       0           0 eth0
```

---

ì´ì œ ìœ„ ì‹œìŠ¤í…œì„ ì¸í„°ë„·ì— ì—°ê²°í•˜ê³  ì‹¶ë‹¤ê³  í•˜ë©´,
ì´ë²ˆì—” ì¸í„°ë„·ì— ì—°ê²°í•  ìƒˆë¡œìš´ ë¼ìš°íŒ… í…Œì´ë¸”ì„ ì¶”ê°€í•´ì•¼í•¨

```Bash
$ ip route add 172.217.194.0/24 via 192.168.2.1
```

<br><img src="./img/linux_networking_basics_img4.png" width="70%"><br>

ì‹¤ì œ ì¸í„°ë„·ì—ëŠ” ë¬´ìˆ˜íˆ ë§ì€ ë„¤íŠ¸ì›Œí¬ê°€ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì—
ê° ë„¤íŠ¸ì›Œí¬ë¥¼ ìœ„í•´ ëª¨ë“  IP ì£¼ì†Œë¥¼ ë¼ìš°íŒ… í…Œì´ë¸”ì— ì¶”ê°€í•˜ëŠ” ëŒ€ì‹ ,
ê° ë¼ìš°íŒ… ì„¤ì •ë§ˆë‹¤ í•œ IPë¥¼ ê°ê° ì„¤ì •í•˜ëŠ” ëŒ€ì‹ ,
ë¼ìš°í„°ë¥¼ ë¯¸ì§€ì˜ ë„¤íŠ¸ì›Œí¬ì— ì´ ë¼ìš°í„°ë¥¼ ê¸°ë³¸ ê²Œì´íŠ¸ì›¨ì´ë¡œ ì‚¬ìš©í•˜ë¼ê³  í•˜ëŠ” ê²ƒ

```Bash
$ ip route add default via 192.168.2.1
```

ëª¨ë“  ìš”ì²­ì€ ì´ ë¼ìš°í„°ë¡œ ì „ë‹¬ë˜ì–´ ì™¸ë¶€ì˜ ì–´ë–¤ ë„¤íŠ¸ì›Œí¬ë¡œë„ ê°ˆ ìˆ˜ ìˆëŠ” ê²ƒ 

ì´ë¥¼ ìœ„í•´ì„œëŠ” ë‹¨ìˆœíˆ ë‹¨ì¼ í…Œì´ë¸” ì—”íŠ¸ë¦¬ì™€ IP ì£¼ì†Œë“¤ì´ ì •ì˜ëœ Default Gateway ë§Œ ìˆìœ¼ë©´ ë¨

default ë§ê³ ë„ `0.0.0.0` ìœ¼ë¡œ ëª…ì‹œí•  ìˆ˜ë„ ìˆìŒ 

```Bash
Destination     Gateway         Genmask         Flags   Metric  Ref     User Iface
default         192.168.2.1     0.0.0.0         UG      0       0           0 eth0   â†--
0.0.0.0         192.168.2.1     0.0.0.0         UG      0       0           0 eth0   â†--   Same
```

ê²Œì´íŠ¸ì›¨ì´ í•„ë“œì— 0.0.0.0ì„ ì…ë ¥í•˜ë©´ ê²Œì´íŠ¸ì›¨ì´ê°€ í•„ìš” ì—†ë‹¤ëŠ” ì˜ë¯¸

```Bash
Destination     Gateway     Genmask         Flags   Metric  Ref     User Iface
192.168.2.1     0.0.0.0     255.255.255.0   UG      0       0           0 eth0
```

ì˜ˆë¥¼ ë“¤ì–´, ì´ ê²½ìš° ì‹œìŠ¤í…œ Cê°€ 192.168.2.0 ë„¤íŠ¸ì›Œí¬ì— ìˆëŠ” ì¥ì¹˜ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´
ìì²´ ë„¤íŠ¸ì›Œí¬ì— ìˆê¸° ë•Œë¬¸ì— ê²Œì´íŠ¸ì›¨ì´ê°€ í•„ìš”í•˜ì§€ ì•ŠìŒ

(ë§Œì•½ íŠ¹ì • ìš”ì²­ì´ ì¸ì…ëœë‹¤ë©´, í•­ìƒ ì‹œìŠ¤í…œ Cì— ë¼ìš°íŒ…ì„ í•´ì£¼ëŠ” ê²½ë¡œ ë‚´ - `192.168.2.0` - ì— ì¡´ì¬í•˜ê¸° ë•Œë¬¸)

<br>

ì—¬ëŸ¬ ë¼ìš°í„°ê°€ ìˆì„ ë•Œ,
ê°€ë ¹ í•˜ë‚˜ëŠ” ì¸í„°ë„·ê³¼ ì—°ê²°ëœ ë¼ìš°í„°, ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ì¸í„°ë„ í”„ë¼ì´ë¹— ë„¤íŠ¸ì›Œí¬ì™€ ì—°ê²°ëœ ë¼ìš°í„°ê°€ ìˆì„ ë•Œ,
ê° ë„¤íŠ¸ì›Œí¬ë¥¼ ìœ„í•œ ì„œë¡œ ì„œë¡œ ë‹¤ë¥¸ ì§„ì… ê²½ë¡œ (Entry)ê°€ í•„ìš”í•¨

```Bash
$ ip route add 192.168.1.0/24 via 192.168.2.2
```

ë§Œì•½ ë‹¹ì‹ ì˜ ì‹œìŠ¤í…œì—ì„œ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´ ì¸í„°ë„· ë¼ìš°íŒ… ì„¤ì •ê³¼ ê²Œì´íŠ¸ì›¨ì´ë¥¼ ë¨¼ì € ì‚´í´ë³´ë©´ ì¢‹ìŒ 

---

Linux ì„œë²„ë¥¼ ë¼ìš°í„°ë¡œ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ, 


```
    ğŸ–¥ï¸   --[eth0]-- 192.168.1.0 --[eth0]--   ğŸ–¥ï¸  ---[eth1]-- 192.168.2.0 --[eth0]--   ğŸ–¥ï¸     
    A                                         B                                        C     
192.168.1.5                       192.168.1.6   192.168.2.6                       192.168.1.6  
```

A, B, C ì„¸ í˜¸ìŠ¤íŠ¸ë¥¼ ë³´ë©´,
Aì™€ BëŠ” `192.168.1.0` ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ë¼ ìˆê³ ,
Bì™€ CëŠ” `192.168.2.0` ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ë¼ ìˆìŒ

í˜¸ìŠ¤íŠ¸ BëŠ” `eth0` ì™€ `eth1`, ë‘ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ì–‘ìª½ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ë˜ì–´ ìˆìŒ

Aì—ì„œ Cë¡œ ì—°ê²°í•˜ë ¤ê³  í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒ

```Bash
# Host A
$ ping 192.168.2.5
Connect: Network is unreachable 
```

ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„  í˜¸ìŠ¤íŠ¸ Bë¥¼ í†µí•´ ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ê·¸ ê³¼ì •ì€ ì•„ë˜ì™€ ê°™ìŒ

<br>

**STEP 1. Setting Routing Configuration: A--B-â†’C**

í˜¸ìŠ¤íŠ¸ Aì—ì„œ Bë¡œ íŒ¨í‚·ì„ ì „ì†¡í•  ìˆ˜ ìˆê²Œ ì„¤ì •

```Bash
# command in Host A
$ ip route add 192.168.2.0/24 via 192.168.1.6
```


```
                                       ------ âœ… ------â†’

    ğŸ–¥ï¸   --[eth0]-- 192.168.1.0 --[eth0]--â†’   ğŸ–¥ï¸  ---[eth1]-- 192.168.2.0 --[eth0]-â†’   ğŸ–¥ï¸     
    A                                         B                                         C     
192.168.1.5                       192.168.1.6   192.168.2.6                        192.168.1.6  
```

ì´ì œ í˜¸ìŠ¤íŠ¸ Aì—ì„œ í˜¸ìŠ¤íŠ¸ Bë¥¼ í†µí•´ í˜¸ìŠ¤íŠ¸ Cë¡œ ìš”ì²­ì´ ì „ë‹¬í•  ìˆ˜ ìˆìŒ

í˜¸ìŠ¤íŠ¸ Cì—ì„œ í˜¸ìŠ¤íŠ¸ Aë¡œ ì‘ë‹µì„ ë³´ë‚´ë ¤ê³  í•  ë•Œë„ ì—°ê²°í•  ìˆ˜ ìˆê²Œ ì„¤ì •í•´ì•¼ í•¨

<br>

**STEP 1. Setting Routing Configuration: C--B-â†’A**

ì´ë²ˆì—” í˜¸ìŠ¤íŠ¸ Cì—ì„œ Aë¡œ íŒ¨í‚·ì„ ì „ë‹¬í•  ìˆ˜ ìˆê²Œ ì„¤ì •í•´ì•¼ í•¨

```Bash
# command in Host B
$ ip route add 192.168.1.0/24 via 192.168.2.6
```

```
                                       â†------  âœ… ------

    ğŸ–¥ï¸   â†--[eth0]-- 192.168.1.0 --[eth0]--   ğŸ–¥ï¸  â†--[eth1]-- 192.168.2.0 --[eth0]--   ğŸ–¥ï¸     
    A                                         B                                          C     
192.168.1.5                       192.168.1.6   192.168.2.6                         192.168.1.6  
```

ì—¬ê¸°ì„œ ping ì„ ë‹¤ì‹œí•´ë³´ë©´ ì „ì†¡ì€ ë˜ì§€ë§Œ ì‘ë‹µì„ ë°›ì„ ìˆ˜ëŠ” ì—†ìŒ

Linuxì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ, í•˜ë‚˜ì˜ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ë¡œ í¬ì›Œë”© ì‹œí‚¤ì§€ ì•ŠìŒ

ë‹¤ì‹œ ë§í•´, `eth0` ë¡œ ë°›ì€ ìš”ì²­ì„ `eth1` ë¡œ ë‚´ë³´ë‚´ì§€ ì•ŠìŒ

ìœ„ì—ì„œë„ í˜¸ìŠ¤íŠ¸ B ì˜ `eth0` ì¸í„°í˜ì´ìŠ¤ì—ì„œ ìˆ˜ì‹ ëœ íŒ¨í‚·ë“¤ì€ `eth1`ì„ í†µí•´ ë‹¤ë¥¸ ê³³ìœ¼ë¡œ ì „ë‹¬ë˜ì§€ ì•ŠìŒ

ì´ëŠ” ë³´ì•ˆìƒì˜ ì´ìœ ì¸ë°, 
ê°€ë ¹, eth0 ì€ Private Networkì— ì—°ê²°ë˜ì–´ ìˆê³ , eth1 ì€ Public Network ìˆë‹¤ê³  ê°€ì •í•´ë³´ì.

ëª…ì‹œì ìœ¼ë¡œ í—ˆìš©í•˜ì§€ ì•ŠëŠ” í•œ Public ë§ì—ì„œ Private ë§ìœ¼ë¡œ ì‰½ê²Œ ì—°ê²°ë˜ëŠ” ê±´ ì§€ì–‘í•˜ê¸° ë•Œë¬¸

í˜¸ìŠ¤íŠ¸ BëŠ” ì‚¬ì„¤ë§ ë‚´ì—ì„œ Aì™€ Cë¥¼ ì—°ê²°í•˜ê³  ì‹¶ì–´í•˜ê¸° ë•Œë¬¸ì—, ì´ë¥¼ í—ˆìš©í•˜ë„ë¡ ëª…ì‹œí•´ì•¼í•¨

í˜¸ìŠ¤íŠ¸ Bì˜ ì„¤ì • ìˆ˜ì •

<br>

**ì„ì‹œ ì„¤ì •**

```Bash
$ cat /proc/sys/net/ipv4/ip_forward
0    â† No Forward
```

ê¸°ë³¸ì ìœ¼ë¡œ `/proc/sys/net/ipv4/ip_forward` ì„¤ì •ì€ `0` ê°’ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆìŒ

ì´ë¥¼ `1`ìœ¼ë¡œ ì„¤ì •

```Bash
$ echo 1 > /proc/sys/net/ipv4/ip_forward
1
```

<br>

**ì˜êµ¬ ì„¤ì •**

```Bash
$ cat /etc/sysctl.conf 
...
net.ipv4.ip_forward
...
```

ì´í›„ë¶€í„° Aì—ì„œ Cê¹Œì§€ ping ëª…ë ¹ì–´ê°€ ìˆ˜í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ 

---

```
# Create network namespaces

ip netns add red
ip netns add blue

# Create veth pairs
ip link add veth-red type veth peer name veth-blue

# Create Add veth to respective namespaces
ip link set veth-red netns red
ip link set veth-blue netns blue

# Set IP Addresses
ip -n red addr add 192.168.1.1 dev veth-red
ip -n blue addr add 192.168.1.2 dev veth-blue

# Check IP Addresses
ip -n red addr
ip -n blue addr

# Bring up interfaces
ip -n red link set veth-red up
ip -n blue link set veth-blue up

# Bring Loopback devices up
ip -n red link set lo up
ip -n blue link set lo up

# Add default gateway
ip netns exec red ip route add default via 192.168.1.1 dev veth-red
ip netns exec blue ip route add default via 192.168.1.2 dev

ip netns del red
ip netns del blue

ip link del v-net-0

iptables -t nat -D POSTROUTING 1

#
ip netns add red
ip netns add blue

ip link add veth-red type veth peer name veth-red-br
ip link add veth-blue type veth peer name veth-blue-br

ip link set veth-red netns red
ip link set veth-blue netns blue

ip -n red addr add 192.168.15.2/24 dev veth-red
ip -n blue addr add 192.168.15.3/24 dev veth-blue


brctl addbr v-net-0

ip link set dev v-net-0 up

ip link set veth-red-br up
ip link set veth-blue-br up
```